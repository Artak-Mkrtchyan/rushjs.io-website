<!-- Navigation -->
<nav class="navbar sticky-top navbar-light bg-light flex-md-nowrap docsite-header">
  <div class="container-fluid">
    <a class="navbar-brand" href="{{ site.baseurl }}/">
      <img src={{ "/images/rush-horiz.svg" | absolute_url }}
            style="height: 40px" alt="rushjs.io" title="rushjs.io" />
    </a>
    <div>

      <!-- SEARCH BOX - BEGIN -->
      <form action="#" class="form" style="display: inline-block; vertical-align: middle;">
        <label class="sr-only" for="search-input">Search documentation</label>
        <input class="form-control" id="search-input" name="search" type="text" placeholder='search docs...' />
      </form>

      <script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
      <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
      <script>
        var client = algoliasearch('{{ site.algolia.application_id }}', '{{ site.algolia.search_only_api_key }}');
        var index = client.initIndex('{{ site.algolia.index_name }}');

        autocomplete('#search-input', { hint: false }, [
          {
            source: autocomplete.sources.hits(index, { hitsPerPage: 5 }),
            displayKey: 'title',
            templates: {
              suggestion: function(suggestion) {
                var resultHeading = '';

                if (suggestion._highlightResult && suggestion._highlightResult.title) {
                  resultHeading = suggestion._highlightResult.title.value;
                } else if (suggestion.title) {
                  resultHeading = suggestion.title;
                } else {
                  if (suggestion.tag_name[0] !== 'h') {
                    // If the suggestion did not match a heading, then we can use the heading
                    // from the hierarchy
                    if (suggestion.hierarchy) {
                      for (var i = 6; i >= 0; --i) {
                        var hierarchyValue = suggestion.hierarchy['lvl' + i.toString()];
                        if (hierarchyValue) {
                          resultHeading = hierarchyValue;
                          break;
                        }
                      }
                    }
                  }
                }

                if (!resultHeading) {
                  resultHeading = suggestion.slug || suggestion.url || '(Untitled)';
                }

                let result = '<b>' + resultHeading + '</b>';

                if (suggestion._snippetResult && suggestion._snippetResult.content) {
                    result += '<br />' + suggestion._snippetResult.content.value;
                } else if (suggestion._highlightResult && suggestion._highlightResult.content) {
                  result += '<br />' + suggestion._highlightResult.content.value;
                } else if (suggestion.content) {
                  result += '<br />' + suggestion.content;
                }

                return '<p>' + result + '</p>';
              }
            }
          }
        ]).on('autocomplete:selected', function(event, suggestion, dataset) {
          console.log(suggestion.url);
          window.location.href = suggestion.url;
        });
      </script>
      <!-- SEARCH BOX - END -->

      {% for link in site.data.navigation.top_nav %}
        <a class="btn {% if link.primary %} btn-primary {% endif %}" href="{{ link.url | absolute_url }}">
          {{ link.title }}
        </a>
      {% endfor %}

    </div>
  </div>
</nav>
